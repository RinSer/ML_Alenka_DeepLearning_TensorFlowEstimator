# Как средствами ML.NET натренировать готовую модель Tensorflow классифицировать изображения путём переноса обучения

Этот проект демонстрирует как с помощью библиотеки ML.NET можно создать собственный классификатор изображений, используя предзаданную модель Tensorflow. Первоначальная модель была обучена различать изображения множества объектов. После переноса обучения вновь созданная модель классифицирует изображения согласно заданным категориям. [Обучение модели классификатора изображений с нуля](https://ru.wikipedia.org/wiki/%D0%A2%D0%B5%D0%BE%D1%80%D0%B8%D1%8F_%D1%80%D0%B0%D1%81%D0%BF%D0%BE%D0%B7%D0%BD%D0%B0%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F_%D0%BE%D0%B1%D1%80%D0%B0%D0%B7%D0%BE%D0%B2) требует настройки миллионов параметров, тонны данных с лейблами и огромное количество вычислительных ресурсов (сотни часов работы графических процессоров). Не равняясь по эффективность с обучением специализированных моделей с нуля, перенос обучения позволяет существенно сократить процесс тренировки классификатора, снижая количество предзадаваемых изображений с лейблами с миллионов до тысяч, а время обучения модели классификатора становится обозримо быстрым (в рамках часа на машинах без графического процессора). 

## Что такое перенос обучения?

Что если бы могли использовать модель уже настроенную решать схожую проблему и переобучить все или некоторые слои этой модели, чтобы она решала нашу задачу? Такая техника использования части уже натренированной модели для построения новой модели называется [переносом обучения](https://en.wikipedia.org/wiki/Transfer_learning).

## Выбор задачи, подходящей для машинного обучения

[Глубокое обучение](https://ru.wikipedia.org/wiki/%D0%93%D0%BB%D1%83%D0%B1%D0%BE%D0%BA%D0%BE%D0%B5_%D0%BE%D0%B1%D1%83%D1%87%D0%B5%D0%BD%D0%B8%D0%B5) является подмножеством [Машинного обучения](https://ru.wikipedia.org/wiki/%D0%9C%D0%B0%D1%88%D0%B8%D0%BD%D0%BD%D0%BE%D0%B5_%D0%BE%D0%B1%D1%83%D1%87%D0%B5%D0%BD%D0%B8%D0%B5). Эта технология произвела революцию в сферах компьютерного зрения и распознания речи. Модели глубокого обучения тренируются с помощью наборов [данных с лейблами](https://en.wikipedia.org/wiki/Labeled_data) и [нейронных сетей](https://en.wikipedia.org/wiki/Artificial_neural_network), которые содержат множество обучаемых слоёв. 
## Глубокое обучение:
* Показывает лучшие результаты для таких задач как компьютерное зрение.
* Показывает хорошие результаты при наличии значительного количества данных.
## Классификация изображений представляет собой распространенную задачу [Машинного обучения](https://ru.wikipedia.org/wiki/%D0%9C%D0%B0%D1%88%D0%B8%D0%BD%D0%BD%D0%BE%D0%B5_%D0%BE%D0%B1%D1%83%D1%87%D0%B5%D0%BD%D0%B8%D0%B5), которая позволяет нам автоматически классифицировать изображения в разные категории, например:
* Распознавание человеческого лица на изображении.
* Различение изображений кошек или собак.
## В целом классификаторы изображений можно использовать для определения наличия любых оптических образов на фотографиях, в том числе брендов и продуктов на полках.
Перенос обучения достигается путём нескольких стратегий, таких как переобучение всех слоёв или одного предпоследнего слоя. Решение применяет стратегию переобучению единственно предпоследнего слоя. Для этой стратегии используется модель, которая была обучена решать схожую задачу (различать изображения других объектов), последний слой этой готовой нейронной сети переобучается, чтобы решать задачу нужную нам (классифицировать наши изображения). Использование уже готовой модели нейронной сети позволит значительно сократить время и ресурсы для создания нашей собственной.
Данный классификатор использует [Inception model](https://storage.googleapis.com/download.tensorflow.org/models/inception5h.zip) - популярную модель классификатора изображений, обучавшуюся на базе данных [ImageNet](https://ru.wikipedia.org/wiki/ImageNet), для которой она научилась различать изображения в тысячи категорий, таких как Зонтик, Свитер или Посудомойка.
Модель *Inception v3* может быть определена как [Свёрточная нейронная сеть](https://ru.wikipedia.org/wiki/%D0%A1%D0%B2%D1%91%D1%80%D1%82%D0%BE%D1%87%D0%BD%D0%B0%D1%8F_%D0%BD%D0%B5%D0%B9%D1%80%D0%BE%D0%BD%D0%BD%D0%B0%D1%8F_%D1%81%D0%B5%D1%82%D1%8C). Её разультаты могут совпадать с чесловеческими и превосходить их в некоторых областях. Сама модель и алгоритм обучения были разработаны группой исследователей на основе оригинальной статьи [Rethinking the Inception Architecture for Computer Vision](https://arxiv.org/abs/1512.00567). 
Благодаря тому что модель заранее обучена распознавать тысячи различных объектов, она содержит черты изображений, необходимые для распознания объектов. Более низкие слои распознают простые черты, такие как край, более высокие слои распознают сложные черты, такие как форма. Финальный слой такой сети может быть обучен на сравнительно небольшом объеме данных, так как сама модель заранее понимает как лучше классифицировать изображения. Эта модель представляет собой пример [многоклассового классификатора](https://docs.microsoft.com/en-us/dotnet/machine-learning/resources/tasks#multiclass-classification), так как позволяет различать сразу несколько классов изображений. 

# Проект ShowTime представляет собой Web приложение, запускающее консольные и демонстрирующее результаты работы классификатора изображений.

## Ссылки на первоначальные проекты:
* [Train/Predict](https://github.com/dotnet/machinelearning-samples/tree/master/samples/csharp/getting-started/DeepLearning_TensorFlowEstimator)
* [TransferLearning](https://docs.microsoft.com/en-us/dotnet/machine-learning/tutorials/image-classification)